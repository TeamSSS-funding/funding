<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="io.github.mygoodsupporter.mapper.AddressMapper">

	<resultMap id="address" type="Address">
		<id column="id" property="id"/>
		<result column="user_id" property="userId"/>
		<result column="city" property="city"/>
		<result column="street" property="street"/>
		<result column="zipcode" property="zipcode"/>
	</resultMap>

	<select id="getAddressesByUserId" parameterType="Long" resultMap="address">
		SELECT id, user_id, city, street, zipcode
		FROM address
		WHERE user_id = #{userId}
	</select>

	<select id="getAddressById" parameterType="Long" resultMap="address">
		SELECT id, user_id, city, street, zipcode
		FROM address
		WHERE id = #{addressId}
	</select>


	<insert id="insertAddress" parameterType="Address" useGeneratedKeys="true" keyProperty="id">
		INSERT INTO address
		    (id, user_id, city, street, zipcode)
		VALUES
			(#{id}, #{userId}, #{city}, #{street}, #{zipcode})
	</insert>

	<update id="updateAddress" parameterType="Address">
		UPDATE address
			<set>
				<if test="city != ''">city = #{city},</if>
				<if test="street != ''">street = #{street},</if>
				<if test="zipcode != ''">zipcode =#{zipcode},</if>
			</set>
		WHERE id = #{id}
	</update>

	<delete id="deleteAddress" parameterType="Long">
		DELETE FROM address WHERE id = #{addressId}
	</delete>

</mapper>